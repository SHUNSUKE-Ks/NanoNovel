# Library BGM Player å¼•ç¶™ãè³‡æ–™
## Layout + æ©Ÿèƒ½ä»•æ§˜

---

## 1. ç”»é¢æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [â†æˆ»ã‚‹] [ğŸµBGM] [1/12]                    [é¸æŠã—ãŸæ›²ã®ã¿ğŸ”˜] [â‰¡]  â”‚ â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚  [ğŸ” æ›²åã€ã¾ãŸã¯èª¬æ˜ã§æ¤œç´¢...]    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”‚  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–   â”‚      â”‚ [ğŸµ] Battle Theme                  â”‚
â”‚    â”‚  â–  NOVEL  GAME â– â–   â”‚      â”‚      battle_theme_01.mp3       [â‹®â‹®]â”‚
â”‚    â”‚  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–   â”‚      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ [ğŸµ] Town BGM                      â”‚
â”‚                                 â”‚      town_peaceful.mp3         [â‹®â‹®]â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”‚  Track Title           â”‚  â”‚ [ğŸµ] Dungeon Theme                 â”‚
â”‚    â”‚  filename.mp3          â”‚  â”‚      dungeon_dark.mp3          [â‹®â‹®]â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”‚ 0:00 â”â”â”â”â”â—â”â”â”â” 3:45  â”‚  â”‚ [ğŸµ] Boss Battle                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚      boss_epic.mp3             [â‹®â‹®]â”‚
â”‚    â”‚  [ğŸ”€] [â®] [â–¶] [â­] [ğŸ”] â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         Player Area            â”‚           Playlist Area             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|---------|------|
| `screens/11_Collection/BGMPlayerScreen.jsx` | ãƒ¡ã‚¤ãƒ³ç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| `hooks/useBGMPlayer.js` | å†ç”Ÿãƒ­ã‚¸ãƒƒã‚¯ï¼ˆuseReducerï¼‰ |
| `components/bgm/NowPlayingControl.jsx` | ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«éƒ¨å“ |
| `styles/screens/bgmPlayer.css` | ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾© |
| `assets/sound/bgm/BGM/00_bgmlist01.json` | ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆJSON |

---

## 3. ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### 3.1 ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆJSON
```json
// 00_bgmlist01.json
{
  "Battle Theme": "battle_theme_01.mp3",
  "Town BGM": "town_peaceful.mp3",
  "Dungeon Theme": "dungeon_dark.mp3"
}
```

### 3.2 Trackå‹ï¼ˆå†…éƒ¨å¤‰æ›å¾Œï¼‰
```typescript
interface Track {
  id: number;
  title: string;      // JSON keyï¼ˆè¡¨ç¤ºåï¼‰
  subtitle: string;   // ãƒ•ã‚¡ã‚¤ãƒ«å
  url: string;        // å®Ÿéš›ã®URLï¼ˆimport.meta.urlè§£æ±ºæ¸ˆã¿ï¼‰
  selected?: boolean; // ãŠæ°—ã«å…¥ã‚Šé¸æŠ
}
```

---

## 4. æ©Ÿèƒ½ä¸€è¦§

### 4.1 å†ç”Ÿã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
| æ©Ÿèƒ½ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|------|-----------|------|
| â–¶/â¸ | `togglePlay()` | å†ç”Ÿ/ä¸€æ™‚åœæ­¢ |
| â® | `previous()` | å‰ã®æ›²ï¼ˆ3ç§’ä»¥ä¸Šå†ç”Ÿæ™‚ã¯é ­å‡ºã—ï¼‰ |
| â­ | `next()` | æ¬¡ã®æ›² |
| ã‚·ãƒ¼ã‚¯ | `seek(time)` | ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚¯ãƒªãƒƒã‚¯ã§ç§»å‹• |

### 4.2 ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
| æ©Ÿèƒ½ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | çŠ¶æ…‹ |
|------|-----------|------|
| ğŸ”€ ã‚·ãƒ£ãƒƒãƒ•ãƒ« | `toggleShuffle()` | `shuffleMode: true/false` |
| ğŸ” ãƒªãƒ”ãƒ¼ãƒˆ | `cycleRepeat()` | `repeatMode: 'off' â†’ 'all' â†’ 'one'` |

### 4.3 ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
| æ©Ÿèƒ½ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|------|-----------|------|
| æ¤œç´¢ | `setSearchQuery(query)` | title/subtitleã§çµã‚Šè¾¼ã¿ |
| é¸æŠã®ã¿ | `setFilter(bool)` | `selected: true`ã®æ›²ã®ã¿è¡¨ç¤º |

---

## 5. Stateæ§‹é€ ï¼ˆuseBGMPlayerï¼‰

```javascript
const initialState = {
  isPlaying: false,
  currentTrackIndex: 0,
  currentTime: 0,
  duration: 0,
  volume: 1,
  isMuted: false,
  shuffleMode: false,
  repeatMode: 'off',      // 'off' | 'all' | 'one'
  playlist: [],
  originalPlaylist: [],
  showSelectedOnly: false,
  searchQuery: '',
};
```

---

## 6. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

### 6.1 BGMPlayerScreen.jsx
```jsx
<div className="bgm-player-screen">
  {/* Header */}
  <header className="bgm-header">
    <button onClick={goBack}>â†</button>
    <span>BGM</span>
    <span>{currentIndex + 1}/{total}</span>
    <label>é¸æŠã—ãŸæ›²ã®ã¿ <input type="checkbox" /></label>
  </header>

  <div className="bgm-main-content">
    {/* å·¦: Player Area */}
    <div className="bgm-player-area">
      <div className="album-art-container">
        <div className="main-album-art">NOVEL GAME</div>
        <NowPlayingControl {...props} />
      </div>
    </div>

    {/* å³: Playlist Area */}
    <div className="bgm-playlist-area">
      <input placeholder="æ›²åã§æ¤œç´¢..." />
      {filteredPlaylist.map(track => (
        <div className="track-item" onClick={() => selectTrack(idx)}>
          <Music />
          <div>{track.title}</div>
          <div>{track.subtitle}</div>
        </div>
      ))}
    </div>
  </div>
</div>
```

### 6.2 NowPlayingControl.jsx
```jsx
<div className="now-playing-container">
  <div className="now-playing-glass-card">
    {/* ãƒˆãƒ©ãƒƒã‚¯æƒ…å ± */}
    <h2>{currentTrack?.title}</h2>
    <p>{currentTrack?.subtitle}</p>

    {/* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */}
    <div className="progress-track" onClick={handleProgressClick}>
      <div style={{ width: `${progress}%` }} />
    </div>
    <span>{formatTime(currentTime)} / {formatTime(duration)}</span>

    {/* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ */}
    <button onClick={onToggleShuffle}><Shuffle /></button>
    <button onClick={onPrevious}><SkipBack /></button>
    <button onClick={onTogglePlay}>{isPlaying ? <Pause /> : <Play />}</button>
    <button onClick={onNext}><SkipForward /></button>
    <button onClick={onToggleRepeat}><Repeat /></button>
  </div>
</div>
```

---

## 7. CSS ã‚¯ãƒ©ã‚¹ä¸€è¦§

| ã‚¯ãƒ©ã‚¹ | ç”¨é€” |
|--------|------|
| `.bgm-player-screen` | ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒ†ãƒŠ |
| `.bgm-header` | ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆæˆ»ã‚‹ãƒœã‚¿ãƒ³ã€ã‚¿ã‚¤ãƒˆãƒ«ç­‰ï¼‰ |
| `.bgm-main-content` | flex: å·¦å³åˆ†å‰² |
| `.bgm-player-area` | å·¦åŠåˆ†ï¼ˆã‚¢ãƒ«ãƒãƒ ã‚¢ãƒ¼ãƒˆ+ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼‰ |
| `.bgm-playlist-area` | å³åŠåˆ†ï¼ˆæ¤œç´¢+ãƒˆãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼‰ |
| `.track-item` | ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å„è¡Œ |
| `.track-item.active` | ç¾åœ¨å†ç”Ÿä¸­ã®ãƒˆãƒ©ãƒƒã‚¯ |
| `.now-playing-glass-card` | ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« |
| `.progress-track` | ã‚·ãƒ¼ã‚¯ãƒãƒ¼èƒŒæ™¯ |
| `.progress-fill` | ã‚·ãƒ¼ã‚¯ãƒãƒ¼é€²æ— |
| `.btn-play-main` | å†ç”Ÿ/åœæ­¢ãƒœã‚¿ãƒ³ï¼ˆå¤§ï¼‰ |

---

## 8. ç§»æ¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] `useBGMPlayer.js` ã‚’ã‚³ãƒ”ãƒ¼
- [ ] `NowPlayingControl.jsx` ã‚’ã‚³ãƒ”ãƒ¼
- [ ] `BGMPlayerScreen.jsx` ã‚’ã‚³ãƒ”ãƒ¼
- [ ] `bgmPlayer.css` ã‚’ã‚³ãƒ”ãƒ¼
- [ ] `00_bgmlist01.json` å½¢å¼ã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆä½œæˆ
- [ ] `formatTime` ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ç”¨æ„
- [ ] lucide-react ã‚¢ã‚¤ã‚³ãƒ³ä¾å­˜ç¢ºèª

---

**Document Version**: 1.0  
**Last Updated**: 2026-01-18
